<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fatos de Gatos</title>
    <!-- Adiciona o framework Tailwind CSS do CDN para estilização -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Adiciona a fonte Inter do Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        /* Definição de keyframes para animação de carregamento */
        @keyframes spin {
            from {
                transform: rotate(0deg);
            }
            to {
                transform: rotate(360deg);
            }
        }
        .animate-spin-slow {
            animation: spin 1.5s linear infinite;
        }
    </style>
</head>
<body class="bg-indigo-50 min-h-screen flex items-center justify-center p-4">

    <!-- Container principal do card do aplicativo -->
    <div class="bg-white p-8 md:p-12 rounded-2xl shadow-2xl max-w-lg w-full text-center border-b-4 border-indigo-500">
        <h1 class="text-3xl md:text-4xl font-bold text-indigo-700 mb-4">Fatos de Gatos</h1>
        <p class="text-gray-600 mb-6">Clique no botão para descobrir um fato aleatório sobre gatos!</p>

        <!-- Área de exibição do fato e carregamento -->
        <div class="relative min-h-[100px] flex items-center justify-center p-4 rounded-xl bg-indigo-50 border border-indigo-200">
            <!-- Texto do fato -->
            <p id="fact-text" class="text-lg md:text-xl text-gray-800 font-semibold transition-opacity duration-300">Carregando um fato de gato...</p>
            
            <!-- Indicador de carregamento -->
            <div id="loading-spinner" class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 text-indigo-500 opacity-0 transition-opacity duration-300">
                <svg class="animate-spin-slow h-8 w-8" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                    <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                    <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                </svg>
            </div>

            <!-- Mensagem de erro -->
            <div id="error-message" class="hidden absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 text-red-500 text-sm font-medium p-2 bg-red-100 rounded">
                <p>Ocorreu um erro ao carregar o fato. Tente novamente.</p>
            </div>
        </div>

        <!-- Botão para gerar um novo fato -->
        <button id="new-fact-btn" class="mt-6 px-8 py-3 bg-indigo-600 text-white font-bold rounded-full shadow-lg hover:bg-indigo-700 transition-colors duration-200 focus:outline-none focus:ring-4 focus:ring-indigo-500 focus:ring-opacity-50">
            Novo Fato
        </button>
    </div>

    <script>
        // Obtém referências para os elementos HTML
        const factText = document.getElementById('fact-text');
        const loadingSpinner = document.getElementById('loading-spinner');
        const newFactBtn = document.getElementById('new-fact-btn');
        const errorMessage = document.getElementById('error-message');

        const apiKey = "AIzaSyAMD0mB_JbdRsionvyC9VYeOzO6UOdIl7s"; // A chave de API será fornecida no ambiente de execução.

        /**
         * Traduz um texto do inglês para o português usando a API do Gemini.
         * @param {string} textToTranslate O texto em inglês a ser traduzido.
         * @returns {Promise<string>} O texto traduzido.
         */
        const translateToPortuguese = async (textToTranslate) => {
            const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=${apiKey}`;
            
            const payload = {
                contents: [{ parts: [{ text: textToTranslate }] }],
                systemInstruction: {
                    parts: [{ text: "Traduza o texto a seguir para o português." }]
                }
            };

            try {
                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });

                if (!response.ok) {
                    throw new Error('Erro na tradução');
                }
                const result = await response.json();
                const translatedText = result.candidates?.[0]?.content?.parts?.[0]?.text;
                return translatedText || textToTranslate; // Retorna o original se a tradução falhar
            } catch (error) {
                console.error("Erro ao traduzir o fato:", error);
                return textToTranslate; // Retorna o texto original em caso de erro
            }
        };

        /**
         * Realiza a chamada à API de fatos de gatos, traduz o resultado e atualiza o texto na tela.
         * Lida com os estados de carregamento e erro.
         */
        const getCatFact = async () => {
            // Exibe o spinner de carregamento e esconde o texto do fato e a mensagem de erro
            loadingSpinner.classList.remove('opacity-0');
            factText.classList.add('opacity-0');
            errorMessage.classList.add('hidden');
            newFactBtn.disabled = true; // Desabilita o botão para evitar cliques múltiplos

            try {
                // 1. Requisição assíncrona para a API de fatos de gatos
                const response = await fetch('https://catfact.ninja/fact');
                if (!response.ok) {
                    throw new Error('Erro na resposta da rede da API de fatos');
                }
                const data = await response.json();
                const englishFact = data.fact;
                
                // 2. Traduz o fato para o português
                const portugueseFact = await translateToPortuguese(englishFact);
                
                // 3. Atualiza o texto com o fato traduzido
                factText.textContent = portugueseFact;
            } catch (error) {
                console.error("Erro ao buscar o fato:", error);
                // Exibe a mensagem de erro
                errorMessage.classList.remove('hidden');
                factText.textContent = ""; // Limpa o texto do fato
            } finally {
                // Esconde o spinner de carregamento e re-exibe o texto do fato
                loadingSpinner.classList.add('opacity-0');
                factText.classList.remove('opacity-0');
                newFactBtn.disabled = false; // Habilita o botão novamente
            }
        };

        // Adiciona um listener de evento ao botão para buscar um novo fato
        newFactBtn.addEventListener('click', getCatFact);

        // Busca o primeiro fato quando a página é carregada
        window.onload = getCatFact;
    </script>
</body>
</html>
